<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ESFOT - Escuela de Formación de Tecnólogos</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    /* --- Aquí va todo el CSS que ya pegaste --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      background: linear-gradient(to right, #0f4c81, #145374);
      color: white;
      padding: 1.5rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    header h1 {
      font-size: 1.8rem;
    }
    header nav {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    header nav a, header nav span {
      color: white;
      font-weight: bold;
      text-decoration: none;
      cursor: pointer;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      border: 2px solid white;
      transition: background 0.3s ease;
    }
    header nav a:hover {
      background: #ffffff44;
    }
    header nav span {
      cursor: default;
      border: none;
      background: none;
    }
    header nav a.logout-btn {
      background: #d9534f;
      border-color: #d9534f;
    }
    header nav a.logout-btn:hover {
      background: #c9302c;
      border-color: #ac2925;
    }
    .hero {
      padding: 3rem 1rem;
      max-width: 900px;
      margin: 1rem auto;
      text-align: center;
    }
    .hero h2 {
      color: #0f4c81;
      margin-bottom: 1rem;
      font-size: 2rem;
    }
    .hero p {
      font-size: 1.1rem;
      color: #555;
      margin-bottom: 2rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 2rem;
      padding: 2rem 1rem;
      max-width: 1100px;
      margin: auto;
    }
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: translateY(-6px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    .card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }
    .card-body {
      padding: 1.5rem;
    }
    .card-body h3 {
      color: #0f4c81;
      margin-bottom: 0.8rem;
    }
    .card-body p {
      font-size: 0.95rem;
      color: #555;
    }
    .prediction-section {
      max-width: 900px;
      margin: 2rem auto;
      padding: 1rem;
      text-align: center;
    }
    .prediction-button {
      display: inline-block;
      background-color: #0f4c81;
      color: white;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    .prediction-button:hover {
      background-color: #084b6f;
    }
    footer {
      margin-top: auto;
      text-align: center;
      font-size: 0.9rem;
      color: #888;
      padding: 1.5rem 1rem;
      background: #f0f0f0;
    }
    /* Chatbot */
    #chat-toggle-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #0f4c81;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      color: white;
      font-size: 28px;
      cursor: pointer;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      display: none; /* Por defecto oculto, solo si está logueado */
    }
    #chatbot-container {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 360px;
      max-width: 90%;
      height: 500px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      display: none;
      flex-direction: column;
      overflow: hidden;
      z-index: 999;
    }
    #chatbot-header {
      background: #0f4c81;
      color: white;
      padding: 1rem;
      text-align: center;
      font-weight: bold;
    }
    #chatWindow {
      flex-grow: 1;
      padding: 1rem;
      overflow-y: auto;
      background: #e9eff6;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .message {
      max-width: 75%;
      padding: 0.8rem 1rem;
      border-radius: 20px;
      white-space: pre-wrap;
      font-size: 0.95rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .user {
      align-self: flex-end;
      background: #0f4c81;
      color: white;
      border-bottom-right-radius: 4px;
      border-bottom-left-radius: 20px;
    }
    .ia {
      align-self: flex-start;
      background: white;
      border: 1.5px solid #0f4c81;
      color: #0f4c81;
      border-bottom-left-radius: 4px;
      border-bottom-right-radius: 20px;
    }
    #chatbot-container footer {
      display: flex;
      padding: 1rem;
      border-top: 1px solid #ccc;
      background: #fff;
      gap: 10px;
    }
    input[type="text"] {
      flex-grow: 1;
      padding: 0.6rem 1rem;
      font-size: 1rem;
      border-radius: 30px;
      border: 1.8px solid #cbd5e1;
      outline: none;
    }
    input[type="text"]:focus {
      border-color: #0f4c81;
    }
    button.send {
      background: #0f4c81;
      color: white;
      font-weight: 600;
      border: none;
      border-radius: 30px;
      padding: 0 1.2rem;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    button.send:hover {
      background-color: #084b6f;
    }

    /* Modal General (login y registro) */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      width: 320px;
      max-width: 100%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      position: relative;
    }
    .modal-content h3 {
      margin-bottom: 1rem;
      text-align: center;
      color: #0f4c81;
    }
    .modal-content label {
      display: block;
      margin-bottom: 0.2rem;
      font-weight: 600;
      color: #333;
    }
    .modal-content input[type="email"],
    .modal-content input[type="password"] {
      width: 100%;
      padding: 0.6rem 1rem;
      margin-bottom: 1.2rem;
      border: 1.8px solid #cbd5e1;
      border-radius: 6px;
      font-size: 1rem;
    }
    .modal-content button {
      width: 100%;
      background-color: #0f4c81;
      color: white;
      font-weight: bold;
      padding: 0.8rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1rem;
      transition: background-color 0.3s ease;
    }
    .modal-content button:hover {
      background-color: #084b6f;
    }
    .modal-close {
      position: absolute;
      top: 12px;
      right: 12px;
      font-size: 1.5rem;
      color: #0f4c81;
      cursor: pointer;
      font-weight: bold;
    }
    .error-msg {
      color: #d9534f;
      font-size: 0.9rem;
      margin-bottom: 0.8rem;
      text-align: center;
    }
  </style>
</head>
<body>

<header>
  <h1>ESFOT</h1>
  <nav id="nav-menu">
    <a href="#" id="login-link">Login</a>
    <a href="#" id="register-link">Registro</a>
  </nav>
</header>

<section class="hero">
  <h2>Bienvenido a la Escuela de Formación de Tecnólogos</h2>
  <p>Formamos profesionales innovadores en diversas áreas de tecnología para construir un futuro mejor.</p>
</section>

<section class="grid">
  <div class="card">
    <img src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=800&q=80" alt="Tecnología y Computación" />
    <div class="card-body">
      <h3>Tecnología y Computación</h3>
      <p>Explora el mundo del desarrollo de software, redes y sistemas.</p>
    </div>
  </div>
  <div class="card">
    <img src="https://images.unsplash.com/photo-1550751827-4e60a2f54b49?auto=format&fit=crop&w=800&q=80" alt="Ingeniería" />
    <div class="card-body">
      <h3>Ingeniería</h3>
      <p>Aprende sobre diseño, análisis y construcción de infraestructuras.</p>
    </div>
  </div>
  <div class="card">
    <img src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80" alt="Investigación" />
    <div class="card-body">
      <h3>Investigación</h3>
      <p>Participa en proyectos que buscan innovación y desarrollo científico.</p>
    </div>
  </div>
</section>

<section class="prediction-section" id="prediction-section" style="display:none;">
  <a href="#" class="prediction-button" id="prediction-link">Ir a la página de predicciones</a>
</section>

<footer>
  &copy; 2025 ESFOT - Todos los derechos reservados.
</footer>

<!-- Botón para abrir chatbot -->
<button id="chat-toggle-btn" title="Chatbot">💬</button>

<!-- Chatbot container -->
<div id="chatbot-container">
  <div id="chatbot-header">Asistente ESFOT</div>
  <div id="chatWindow"></div>
  <footer>
    <input type="text" id="userInput" placeholder="Escribe tu mensaje..." autocomplete="off" />
    <button class="send" id="sendBtn">Enviar</button>
  </footer>
</div>

<!-- Modal Login -->
<div class="modal" id="login-modal">
  <div class="modal-content">
    <span class="modal-close" id="login-close">&times;</span>
    <h3>Iniciar Sesión</h3>
    <div class="error-msg" id="login-error"></div>
    <label for="login-email">Email</label>
    <input type="email" id="login-email" placeholder="usuario@correo.com" />
    <label for="login-password">Contraseña</label>
    <input type="password" id="login-password" placeholder="******" />
    <button id="login-submit">Ingresar</button>
  </div>
</div>

<!-- Modal Registro -->
<div class="modal" id="register-modal">
  <div class="modal-content">
    <span class="modal-close" id="register-close">&times;</span>
    <h3>Registro</h3>
    <div class="error-msg" id="register-error"></div>
    <label for="register-email">Email</label>
    <input type="email" id="register-email" placeholder="usuario@correo.com" />
    <label for="register-password">Contraseña</label>
    <input type="password" id="register-password" placeholder="******" />
    <button id="register-submit">Registrar</button>
  </div>
</div>

<script>
  // Manejo de estado de usuario (localStorage simulado)
  const navMenu = document.getElementById('nav-menu');
  const loginLink = document.getElementById('login-link');
  const registerLink = document.getElementById('register-link');
  const predictionSection = document.getElementById('prediction-section');
  const chatToggleBtn = document.getElementById('chat-toggle-btn');
  const chatbotContainer = document.getElementById('chatbot-container');

  const loginModal = document.getElementById('login-modal');
  const loginClose = document.getElementById('login-close');
  const loginSubmit = document.getElementById('login-submit');
  const loginEmail = document.getElementById('login-email');
  const loginPassword = document.getElementById('login-password');
  const loginError = document.getElementById('login-error');

  const registerModal = document.getElementById('register-modal');
  const registerClose = document.getElementById('register-close');
  const registerSubmit = document.getElementById('register-submit');
  const registerEmail = document.getElementById('register-email');
  const registerPassword = document.getElementById('register-password');
  const registerError = document.getElementById('register-error');

  const chatWindow = document.getElementById('chatWindow');
  const userInput = document.getElementById('userInput');
  const sendBtn = document.getElementById('sendBtn');

  let currentUser = localStorage.getItem('esfotUser') || null;

  // Función para mostrar usuario logueado en menú
  function updateUIForUser() {
    if(currentUser) {
      navMenu.innerHTML = `
        <span>Bienvenido, ${currentUser}</span>
        <a href="#" id="logout-btn" class="logout-btn">Cerrar sesión</a>
      `;
      predictionSection.style.display = 'block';
      chatToggleBtn.style.display = 'block';

      document.getElementById('logout-btn').addEventListener('click', () => {
        logoutUser();
      });
    } else {
      navMenu.innerHTML = `
        <a href="#" id="login-link">Login</a>
        <a href="#" id="register-link">Registro</a>
      `;
      predictionSection.style.display = 'none';
      chatToggleBtn.style.display = 'none';

      // Re-attach listeners
      document.getElementById('login-link').addEventListener('click', (e) => {
        e.preventDefault();
        openLoginModal();
      });
      document.getElementById('register-link').addEventListener('click', (e) => {
        e.preventDefault();
        openRegisterModal();
      });
    }
  }

  function logoutUser() {
    currentUser = null;
    localStorage.removeItem('esfotUser');
    updateUIForUser();
    chatbotContainer.style.display = 'none';
  }

  function openLoginModal() {
    loginError.textContent = '';
    loginEmail.value = '';
    loginPassword.value = '';
    loginModal.classList.add('active');
  }

  function openRegisterModal() {
    registerError.textContent = '';
    registerEmail.value = '';
    registerPassword.value = '';
    registerModal.classList.add('active');
  }

  loginLink.addEventListener('click', (e) => {
    e.preventDefault();
    openLoginModal();
  });

  registerLink.addEventListener('click', (e) => {
    e.preventDefault();
    openRegisterModal();
  });

  loginClose.addEventListener('click', () => {
    loginModal.classList.remove('active');
  });
  registerClose.addEventListener('click', () => {
    registerModal.classList.remove('active');
  });

  // Login Submit
  loginSubmit.addEventListener('click', () => {
    const email = loginEmail.value.trim();
    const pass = loginPassword.value.trim();

    // Validar simple
    if(!email || !pass) {
      loginError.textContent = 'Por favor complete todos los campos.';
      return;
    }

    // Simulación de autenticación
    // En un sistema real, aquí llamarías a backend API para validar usuario
    // Para demo, guardamos en localStorage y aceptamos cualquier usuario registrado

    let registeredUsers = JSON.parse(localStorage.getItem('esfotRegisteredUsers') || '{}');
    if(registeredUsers[email] && registeredUsers[email] === pass) {
      currentUser = email;
      localStorage.setItem('esfotUser', currentUser);
      loginModal.classList.remove('active');
      updateUIForUser();
    } else {
      loginError.textContent = 'Credenciales incorrectas.';
    }
  });

  // Registro Submit
  registerSubmit.addEventListener('click', () => {
    const email = registerEmail.value.trim();
    const pass = registerPassword.value.trim();

    if(!email || !pass) {
      registerError.textContent = 'Por favor complete todos los campos.';
      return;
    }

    // Simulación simple de registro
    let registeredUsers = JSON.parse(localStorage.getItem('esfotRegisteredUsers') || '{}');
    if(registeredUsers[email]) {
      registerError.textContent = 'El usuario ya está registrado.';
      return;
    }

    registeredUsers[email] = pass;
    localStorage.setItem('esfotRegisteredUsers', JSON.stringify(registeredUsers));
    currentUser = email;
    localStorage.setItem('esfotUser', currentUser);
    registerModal.classList.remove('active');
    updateUIForUser();
  });

  // Toggle chatbot
  chatToggleBtn.addEventListener('click', () => {
    if(chatbotContainer.style.display === 'flex') {
      chatbotContainer.style.display = 'none';
    } else {
      chatbotContainer.style.display = 'flex';
      userInput.focus();
    }
  });

  // Enviar mensaje
  sendBtn.addEventListener('click', sendMessage);
  userInput.addEventListener('keydown', (e) => {
    if(e.key === 'Enter') sendMessage();
  });

  function appendMessage(text, sender) {
    const msgDiv = document.createElement('div');
    msgDiv.classList.add('message', sender);
    msgDiv.textContent = text;
    chatWindow.appendChild(msgDiv);
    chatWindow.scrollTop = chatWindow.scrollHeight;
  }

  async function sendMessage() {
    const message = userInput.value.trim();
    if(!message) return;
    appendMessage(message, 'user');
    userInput.value = '';
    appendMessage('Escribiendo...', 'ia');

    // Simulación de respuesta IA (puedes cambiar aquí la integración)
    // Simulamos retardo y respuesta

    // Eliminar el "Escribiendo..."
    const typingMsg = chatWindow.querySelector('.message.ia:last-child');
    if(typingMsg) chatWindow.removeChild(typingMsg);

    // Respuesta simple
    const response = await getChatbotResponse(message);
    appendMessage(response, 'ia');
  }

  // Simulación simple de IA
  async function getChatbotResponse(input) {
    input = input.toLowerCase();

    if(input.includes('hola') || input.includes('buenos días') || input.includes('buenas tardes')) {
      return '¡Hola! ¿En qué puedo ayudarte hoy?';
    }
    if(input.includes('carrera') || input.includes('carreras')) {
      return 'En ESFOT ofrecemos diversas carreras como Tecnología, Ingeniería e Investigación.';
    }
    if(input.includes('horarios')) {
      return 'Los horarios varían según la carrera, pero normalmente las clases son de lunes a viernes en la mañana y tarde.';
    }
    if(input.includes('contacto')) {
      return 'Puedes contactarnos al correo info@esfot.edu o al teléfono (593) 123-4567.';
    }
    return 'Lo siento, no entendí tu pregunta. ¿Puedes reformularla?';
  }

  // Inicializar UI según usuario logueado
  updateUIForUser();

</script>

</body>
</html>
